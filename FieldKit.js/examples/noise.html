<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head profile="http://gmpg.org/xfn/11">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="en-UK" />
    <title>FieldKit.js: Noise Test</title>
	
	<script src="../build/fieldkit.js" type="text/javascript" charset="utf-8" ></script>
	
	<style type="text/css">
		#stage canvas {
			border: 2px solid black;
			display: block;
		}
	</style>
  </head>
  <body>
	<h1>FieldKit.js: Noise Test</h1>
	<div id="stage"></div>
	<div id="controls">
		<input type="button" value="gradient" onclick="draw(gradient)" />
		<input type="button" value="noise 2d" onclick="draw(noise2d)" />
		<input type="button" value="noise 3d" onclick="draw(noise3d)" />
		<input type="button" value="noise 4d" onclick="draw(noise4d)" />
	</div>
	<script type="text/javascript">
		// settings
		var width = 320;
		var height = 240;
		
		// init
		var stage = document.getElementById('stage');
		var canvas = document.createElement("canvas");
	 	var context = canvas.getContext('2d');
		canvas.width = width;
		canvas.height = height;
		stage.appendChild(canvas);
	
		// draw methods
		function draw(body) {
			var canvasData = context.getImageData(0,0,canvas.width,canvas.height);			
			body(canvasData);
			context.putImageData(canvasData,0,0);
		};
		
		function gradient(canvasData) {
			var data = canvasData.data
			for(var x=0; x<canvasData.width; x++) {
				for(var y=0; y<canvasData.height; y++) {
					var i = (x + y * canvasData.width) * 4
					var c = y/canvasData.height * 255
					data[i + 0] = c
					data[i + 1] = c
					data[i + 2] = c
					data[i + 3] = 255
				}
			}
		};
		
		function noise2d(canvasData) {			
			var data = canvasData.data
			for(var x=0; x<canvasData.width; x++) {
				for(var y=0; y<canvasData.height; y++) {
					var i = (x + y * canvasData.width) * 4
					var c = fk.math.noise(x,y) * 255
					
					data[i + 0] = c
					data[i + 1] = c
					data[i + 2] = c
					data[i + 3] = 255
				}
			}		
		};
		
		function noise3d(canvasData) {
			var data = canvasData.data
			for(var x=0; x<canvasData.width; x++) {
				for(var y=0; y<canvasData.height; y++) {
					var i = (x + y * canvasData.width) * 4
					data[i + 0] = fk.math.noise(x,y,0) * 255
					data[i + 1] = fk.math.noise(x,y,1) * 255
					data[i + 2] = fk.math.noise(x,y,2) * 255
					data[i + 3] = 255
				}
			}		
		}
		
		function noise4d(canvasData) {
			var data = canvasData.data
			for(var x=0; x<canvasData.width; x++) {
				for(var y=0; y<canvasData.height; y++) {
					var i = (x + y * canvasData.width) * 4;

					data[i + 0] = fk.math.noise(x,y,1,0) * 255;
					data[i + 1] = fk.math.noise(x,y,2,1) * 255;
					data[i + 2] = fk.math.noise(x,y,3,2) * 255;
					data[i + 3] = fk.math.noise(x,y,4,3) * 255;
				}
			}		
		}
		
		// benchmark methods
		function benchmark(name, func) {
			console.log('running test: '+ name)
			var start = new Date()
			//for(var i=0; i<10000; i++) {
				func()
			//}				
			var stop = new Date()				
			console.log('finished => '+ (stop - start) +'ms')
		}
		
		benchmark("noise 2d "+ width +"x"+ height, 
				  function() { draw(noise2d) } )
		
		fk.info('testing')
		for(var i=0; i<10; i++) {
			fk.info('i',i,' ', fk.math.noise(i,0))
		}
		// test methods
		// fk.info('fk.math.noise(0,0)', fk.math.noise(0,0))
		// fk.info('fk.math.noise(1,2)', fk.math.noise(1,2))			
		// fk.info('fk.math.noise(2.331,4.12312)', fk.math.noise(2.331,4.12312))
		
	</script>
  </body>
</html>